# vim: filetype=conf

set shell bash
set shellopts '-eu'
set icons
set scrolloff 10
set ifs "\n"
set hidden true
set drawbox
set ratios 1
set info size:time

# open script
map o open

# use enter for shell commands
map <enter> shell

# Rename
map A rename # at the very end
map I push A<c-a> # at the very beginning
map i push A<a-b><a-b><a-f> # before extention
map a push A<a-b> # after extention
map B bulkrename

# Search with fzf
map <c-f> $lf -remote "send $id select '$(fzf)'"

# Put lf into background
map <c-z> $ kill -STOP $PPID

# cmd functions

cmd bulkrename $vidir

cmd mkdir $mkdir -p "$(echo $* | tr ' ' '\ ')"

cmd paste &{{
    set -- $(cat ~/.local/share/lf/files)
    mode="$1"
    shift
    case "$mode" in
        copy)
            rsync -av --ignore-existing --progress -- "$@" . |
            stdbuf -i0 -o0 -e0 tr '\r' '\n' |
            while IFS= read -r line; do
                lf -remote "send $id echo $line"
            done
            ;;
        move) mv -n -- "$@" .;;
    esac
    rm ~/.local/share/lf/files
    lf -remote "send clear"
}}

# Source shortcuts file
source "~/.config/lf/shortcutrc"
