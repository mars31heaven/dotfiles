# vim: filetype=conf

set previewer "~/.config/lf/preview"
set preview
set shell bash
set shellopts '-eu'
set icons
set ifs "\n"
set hiddenfiles ".*:*.aux:*.log:*.bbl:*.bcf:*.blg:*.run.xml"

# Open script
map o open

# Use enter for shell commands
map <enter> shell

# Basic functions
map . set hidden!
map u half-up
map d half-down
map D delete
map p paste
map x cut
map X extract
map y copy
map Y copyto
map M moveto
map R reload
map U unselect
map <c-n> push :mkdir<space>
map W $setsid -f $TERMINAL >/dev/null 2>&1
map E push :!vim<space>

# Rename
map A rename # at the very end
map I push A<c-a> # at the very beginning
map i push A<a-b><a-b><a-f> # before extention
map a push A<a-b> # after extention
map B bulkrename

# Search with fzf
map <c-f> $lf -remote "send $id select '$(fzf)'"

# Put lf into background
map <c-z> $ kill -STOP $PPID

# cmd functions

# Bulkrename files and directories with Vim
# using the vidir command from the moreutils package
cmd bulkrename $vidir

# Type mkdir and give the new directory a name
cmd mkdir $mkdir -p "$(echo $* | tr ' ' '\ ')"

cmd moveto ${{
	clear; tput cup $(($(tput lines)/3))
	dest="$(find $HOME /media -type d | fzf)" &&
	for x in $fx; do
		eval mv -iv \"$x\" \"$dest\"
	done
}}

cmd copyto ${{
	clear; tput cup $(($(tput lines)/3))
	dest="$(find $HOME /media -type d | fzf)" &&
	for x in $fx; do
		eval cp -ivr \"$x\" \"$dest\"
	done
}}

cmd extract ${{
case "$f" in
	*.zip) unzip "$f" ;;
      	*.7z) 7z x "$f" ;;
      	*.tar.gz) tar -xzvf "$f" ;;
      	*.tar.bz2) tar -xjvf "$f" ;;
      	*.tar) tar -xvf "$f" ;;
      	*.rar) unrar x "$f" ;;
      	*) echo "Unsupported format" ;;
esac
}}

# Source file for bound bookmarked directories
source "~/.config/lf/shortcutrc"
