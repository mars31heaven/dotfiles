#!/bin/sh

# open files with fzf
o() {
	open "$(find -type f | fzf)"
}

# preview and open files with fzf
O() {
	fzf --preview="highlight -O ansi {}" --preview-window=right:70%:wrap --query="$given_file"

}

# cd with fzf and bind it to ctrl+f
fcd() {
	cd "$(find -type d | fzf)"
}

bind '"\C-f":"fcd\n"'

# Remove files with fzf
R() {
	rm -rvI "$(ls | fzf -m)"
}

# Autogenerate .m3u playlist files
play() {
	for f in *.mp3; do echo "$f" >> play.m3u; done
}

# Convert magnet links into .torrent files
mag2torrent() {
	aria2c --bt-metadata-only=true --bt-save-metadata=true --listen-port=6881 "$1"
}

# Open another terminal on the current working directory
# and bind it to ctrl+w
smdir() {
	setsid -f "$TERMINAL"
}

bind '"\C-w":"smdir\n"'

# Play a random internet radio station
radio() {
	pkill -f "mpv --no-terminal http*"; cat ~/.local/share/internet_radio | shuf | sed -n 1p | xargs bgmus
}

# Use lf to switch directories and bind it to ctrl+o
lfcd() {
    tmp="$(mktemp)"
    lf -last-dir-path="$tmp" "$@"
    if [ -f "$tmp" ]; then
        dir="$(cat "$tmp")"
        rm -f "$tmp" >/dev/null
        [ -d "$dir" ] && [ "$dir" != "$(pwd)" ] && cd "$dir"
    fi
}

bind '"\C-o":"lfcd\n"'

# Edit a command with vim when in insert mode and bind it to ctrl+e
bind '"\C-e": "\e^v \n"'

# Get the current ip address
ipa() {
	ip addr | grep 192 | awk '{print $2}' | sed 's\/24\\'
}
